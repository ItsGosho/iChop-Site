<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<div id="home-page" class="container d-flex justify-content-center align-items-center">
    <div class="row">

        <div id="news" class="col-xs-6">
            <div class="card">
                <div class="card-header">
                    <small>üì∞</small>
                    News:
                </div>
                <th:block th:if="${!#lists.isEmpty(threads)}">

                <th:block th:each="thread : ${threads}">
                    <div th:id="${thread.getId()}" class="card-body">
                        <div class="row">
                            <div class="col-md-8">
                                <h3 class="title" th:text="${thread.getTitle()}">...</h3>
                            </div>
                            <div class="col-md-4">
                                <small style="display: inline-block;padding-top: 18px;float:right;">
                                    <small class="dateIcon">üìÖ</small>
                                    <small class="date" th:text="${#temporals.format(thread.getCreatedOn(), 'dd MMM,yyyy')}">9 Jan,2018</small>
                                </small>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-8">
                                <small>by <a href="/SMENI">üë§<span class="user" th:text="${thread.getCreator().getUsername()}">ItsGosho</span></a> at
                                    <span
                                        class="postTime" th:text="${#temporals.format(thread.getCreatedOn(), 'HH:mm')}">16:32</span>
                                    <th:block sec:authorize="isAnonymous()">
                                        (<span
                                            class="totalViews" th:text="${thread.getTotalViews()}">0</span>üëÄ / <span
                                            class="totalLikes" th:text="${thread.getTotalReactions()}">0</span>üëç)
                                    </th:block>
                                    <th:block sec:authorize="isAuthenticated()">
                                        <th:block sec:authorize="hasAuthority('MODERATOR')">
                                            (<a href="/SAMO AKO IMA PRAVA"><span
                                                class="totalViews" th:text="${thread.getTotalViews()}">0</span></a>üëÄ / <a href="/SAMO AKO IMA PRAVA"><span
                                                class="totalLikes" th:text="${thread.getTotalReactions()}">0</span></a>üëç)
                                        </th:block>
                                        <th:block sec:authorize="!hasAuthority('MODERATOR')">
                                            (<span
                                                class="totalViews" th:text="${thread.getTotalViews()}">0</span>üëÄ / <span
                                                class="totalLikes" th:text="${thread.getTotalReactions()}">0</span>üëç)
                                        </th:block>
                                    </th:block>
                                </small>
                            </div>
                            <div class="col-md-4">
                                <small style="display: inline-block;padding-top: 18px;float:right;">
                                    <small>üí¨</small>
                                    <a href="/SMENI"><span class="totalComments" th:text="${thread.getTotalComments()}"></span></a> Comments
                                </small>
                            </div>
                        </div>
                        <div class="dropdown-divider"></div>

                        <div class="content" th:id="'content' + ${thread.getId()}">
                            <p class="card-text" style="width: 60vw;min-width: 230px" th:utext="${thread.getContent()}">

                            </p>
                        </div>

                        <script th:inline="javascript">
                            $(`#content`+[[${thread.getId()}]]).empty();
                            if([[${thread.getRowsForNewsPage()}]]!==0){
                                for (let i = 0; i < [[${thread.getRowsForNewsPage()}]]; i++) {
                                    $(`#`+[[${thread.getId()}]]).append($($.parseHTML([[${thread.getContent()}]]))[i]);
                                }
                            }else{
                                for (let i = 0; i < $($.parseHTML([[${thread.getContent()}]])).length; i++) {
                                    $(`#`+[[${thread.getId()}]]).append($($.parseHTML([[${thread.getContent()}]]))[i]);
                                }
                            }
                        </script>

                        <div class="dropdown-divider"></div>

                        <div class="row">
                            <div class="col-md-8">
                                <div class="btn-group">
                                    <th:block sec:authorize="isAuthenticated()">
                                        <th:block sec:authorize="hasAuthority('MODERATOR')">
                                            <button class="btn btn-secondary btn-sm dropdown-toggle" type="button"
                                                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                <small>‚öô</small>
                                                Options
                                            </button>
                                            <div class="dropdown-menu">
                                                <th:block sec:authorize="hasAuthority('ADMIN')">
                                                    <a class="dropdown-item" th:href="@{/thread/{id}/delete(id=${thread.getId()})}">
                                                        <small>‚ùå</small>
                                                        Delete</a>
                                                </th:block>
                                            </div>
                                        </th:block>
                                    </th:block>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <button type="button" style="display: inline-block;float:right;"
                                        class="btn btn-primary btn-sm btn-brand btn-reddit">
                                    <small>üìñ</small>
                                    Continue reading...
                                </button>
                            </div>
                        </div>
                    </div>
                </th:block>

                <nav aria-label="Page navigation example" class="d-flex justify-content-center align-items-center">
                    <ul class="pagination">

                        <th:block th:if="${#request.getParameter('page')} != null">

                            <th:block th:if="${(#conversions.convert(#request.getParameter('page'), 'Integer')) - 1} >= 0">
                                <li class="page-item"><a class="page-link" th:href="@{/(page=${(#conversions.convert(#request.getParameter('page'), 'Integer')) - 1})}">Previous</a></li>
                            </th:block>

                        </th:block>

                        <th:block th:each="i: ${#numbers.sequence(1,totalPages)}">
                            <li class="page-item"><a class="page-link" th:text="${i}" th:href="@{/?page={pId}(pId=${i-1})}"></a></li>
                        </th:block>


                        <th:block th:if="${#request.getParameter('page')} != null">

                            <th:block th:if="${(#conversions.convert(#request.getParameter('page'), 'Integer')) + 1 <= totalPages-1}">
                                <li class="page-item"><a class="page-link" th:href="@{/(page=${(#conversions.convert(#request.getParameter('page'), 'Integer')) + 1})}">Next</a></li>
                            </th:block>

                        </th:block>


                    </ul>
                </nav>


                <div class="dropdown-divider"></div>
                </th:block>

                <th:block th:if="${#lists.isEmpty(threads)}">
                    There are no news!
                </th:block>
            </div>
        </div>

        <th:block th:insert="navbar/right-base-navbar"></th:block>
    </div>
</div>